<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
 	<meta name="baidu-site-verification" content="EuNPeTHGFx" />
    <title>充值</title>

    <meta name="description" content="Source code generated using layoutit.com">
    <meta name="author" content="LayoutIt!">
 	<meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
    <link href="/css/button.css" rel="stylesheet">
     <link rel="stylesheet" href="../../jqwidgets/styles/jqx.base.css" type="text/css" />
      <link rel="stylesheet" href="/css/pay.css">
    <script type="text/javascript" src="/scripts/jquery-1.11.1.min.js"></script>
    
    <script type="text/javascript" src="/js/jqthumb.min.js"></script>
     <script src="https://cdn.staticfile.org/vue/2.2.2/vue.min.js"></script>
	<script src="https://cdn.staticfile.org/vue-resource/1.5.1/vue-resource.min.js"></script>
    
   
  
     
	<style>
	body { width:80%; margin:50px auto; }
	// Extra small devices (portrait phones, less than 576px)
	@media (max-width: 575.98px) { ... }
	
	// Small devices (landscape phones, 576px and up)
	@media (min-width: 576px) and (max-width: 767.98px) { ... }
	
	// Medium devices (tablets, 768px and up)
	@media (min-width: 768px) and (max-width: 991.98px) { ... }
	
	// Large devices (desktops, 992px and up)
	@media (min-width: 992px) and (max-width: 1199.98px) { ... }
	
	// Extra large devices (large desktops, 1200px and up)
	@media (min-width: 1200px) { ... }
	ul {
    display: block;
    overflow: hidden;
    white-space:nowrap;
	}
	li{
    list-style: none;
    display: inline-block;
    margin-left: 15px;
    width: 130px;
	}
	.cp{

	width: 450px;
	height: 470px;
	overflow: hidden;
	display: table-cell;
	vertical-align: middle;
	border:3px solid #000;
	text-align: center;
	}
	.cpimg{
	
	max-width: 100%;
	max-height: 100%;（或者max-height: 100%;）
	display: block;
	margin: 0 auto;
	
	}
	.cdiv{ border:3px solid #000} 
	</style>
	
	<script type="text/javascript">
	
	  $(document).ready(function () {
          // prepare the data
          var user_name=$("#user_name").val();
          //alert(user_name)
          if(user_name!=null&&user_name!==''){
        	  $("#login").html("你好   "+user_name);
          }
          
          var data=null
          $.ajaxSetup({

          	async:false

          });
          $.ajax({
              type: "post",
              url: "/queryIndexCoverPhoto",
              data: {},
              dataType: "json",
              success: function(data){
            	var coverphotoArr = data;
            	var converGroup="";
            	for(var i=0;i<coverphotoArr.length;i++){
            		　　//alert(coverphotoArr[i].coverphotoid);
            		var id=coverphotoArr[i].id;
            		var baiduyun_pass=coverphotoArr[i].baiduyun_pass;
            		var baiduyun_address=coverphotoArr[i].baiduyun_address;
            		//alert(baiduyun_address)
            		//alert(coverphotoArr[i].coverphotoid)
            		var tableContent="";
                  	tableContent += '<div class="col-sm-6 col-md-4">';
                    tableContent += '<div class="thumbnail">';
                  
                    tableContent += '<a href="/details?id='+id+'&baiduyun_pass='+baiduyun_pass+'">';
                    var coverid="/images/"+coverphotoArr[i].coverphotoid.substring(30);
                   // alert(coverid)
                    tableContent += '<img  class="img-responsive"   src="' + coverid+ '" >';
                    tableContent += '</a>';
                    
                    tableContent += '<div class="caption">';
                  	tableContent += '<p>"' + coverphotoArr[i].video_name+ '"</p>';
                    tableContent += ' <p><a href="/details?id='+id+'&baiduyun_pass='+baiduyun_pass+'&baiduyun_address='+baiduyun_address+'" class="btn btn-primary" role="button"> 查看</a> <a href="/details?id='+id+'&baiduyun_pass='+baiduyun_pass+'" class="btn btn-default" role="button">  下载</a></p> ';
                  
                    tableContent += '</p>';
                    tableContent += '<div>';
                    tableContent += '</div></div></div></div>';
                    
                   
                  
                    converGroup+=tableContent;
                    
            	}
            	$("#coverphoto").append(converGroup);
           	   
              	
             }
          });
          /* function encode64(input) {
        	  	var keyStr = input;
        	    var output = "";
        	    var chr1, chr2, chr3 = "";
        	    var enc1, enc2, enc3, enc4 = "";
        	    var i = 0;
        	    do {
        	            chr1 = input.charCodeAt(i++);
        	            chr2 = input.charCodeAt(i++);
        	            chr3 = input.charCodeAt(i++);
        	            enc1 = chr1 >> 2;
        	            enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
        	            enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
        	            enc4 = chr3 & 63;
        	            if (isNaN(chr2)) {
        	                    enc3 = enc4 = 64;
        	            } else if (isNaN(chr3)) {
        	                    enc4 = 64;
        	            }
        	            output = output + keyStr.charAt(enc1) + keyStr.charAt(enc2)
        	                            + keyStr.charAt(enc3) + keyStr.charAt(enc4);
        	            chr1 = chr2 = chr3 = "";
        	            enc1 = enc2 = enc3 = enc4 = "";
        	    } while (i < input.length);
        	 
        	    return output;
        	} */
        	
         
          
      });
        
  	
	
	</script>
  </head>
  <body bgcolor="#DDDDDD">
	<div th:include="header :: header"></div> 
	<div class="container-fluid">
  		<div class="row">
	  		<div style="margin-top: 10%">
		  		<nav class="navbar navbar-default" role="navigation">
				    <div class="container-fluid">
				    
				    <div>
				        <ul class="nav navbar-nav">
				            <li> <a href="" class="navbar-brand">充值中心</a></li>
				          
				         </ul>
				    </div>
				    </div>
				</nav>
			</div>
		</div>
	</div>
		<p></p><p></p>
		<div class="row">
				<div class="col-md-8" >
					 <div class="charge-form-container" style="margin-left: 15%" id="app1">

					    <div class="charge-form" >
					      <form action="">
					        <div>
					          <p>请选择充值金额</p>
					          <div class="charge-group">
					            <div class="charge-group__inner">
					              <label class="charge-item">
					                <input type="radio" name="amount" value="10">
					                <div class="charge-item__inner">
					                  <p>10元</p>
					                  <span>100金币</span>
					                </div>
					              </label>
					              <label class="charge-item">
					                <input type="radio" name="amount" value="20">
					                <div class="charge-item__inner">
					                  <p>20元</p>
					                  <span>200金币</span>
					                </div>
					              </label>
					              <label class="charge-item">
					                <input type="radio" name="amount" value="30">
					                <div class="charge-item__inner">
					                  <p>30元</p>
					                  <span>300金币</span>
					                </div>
					              </label>
					              <label class="charge-item">
					                <input type="radio" name="amount" value="40">
					                <div class="charge-item__inner">
					                  <p>40元</p>
					                  <span>400金币</span>
					                </div>
					              </label>
					              <label class="charge-item">
					                <input type="radio" name="amount" value="50">
					                <div class="charge-item__inner">
					                  <p>50元</p>
					                  <span>500金币</span>
					                </div>
					              </label>
					              <label class="charge-item">
					                <input type="radio" name="amount" value="60">
					                <div class="charge-item__inner">
					                  <p>60元</p>
					                  <span>600金币</span>
					                </div>
					              </label>
					              <label class="charge-item">
					                <input type="radio" name="amount" value="70">
					                <div class="charge-item__inner">
					                  <p>70元</p>
					                  <span>700金币</span>
					                </div>
					              </label>
					              <label class="charge-item">
					                <input type="radio" name="amount" value="80">
					                <div class="charge-item__inner">
					                  <p>80元</p>
					                  <span>800金币</span>
					                </div>
					              </label>
					              <label class="charge-item">
					                <input type="radio" name="amount" value="90">
					                <div class="charge-item__inner">
					                  <p>90元</p>
					                  <span>900金币</span>
					                </div>
					              </label>
					              <label class="charge-item">
					                <input type="radio" name="amount" value="100">
					                <div class="charge-item__inner">
					                  <p>100元</p>
					                  <span>1000金币</span>
					                </div>
					              </label>
					            </div>
					          </div>
					          <p>请选择充值方式</p>
					          <div class="charge-group">
					            <div class="charge-group__inner">
					              <label class="charge-item">
					                <input type="radio" name="payType">
					                <div class="charge-item__inner">
					                  <div class="wechat-label" v-on:click="paytype('1')">
					                  </div>
					                 
					                </div>
					              </label>
					              <label class="charge-item">
					                <input type="radio" name="payType">
					                <div class="charge-item__inner">
					                  <div class="wechat-label1" v-on:click="paytype('2')">
					                  </div>
					                 
					                </div>
					              </label>
					            </div>
					          </div>
					          
					              
					          
					          <input id="type"  name="type" v-model="type" style="display: none">
					          <p>需要支付金额</p>
					          <div class="charge-group">
					            <div class="charge-group__inner">
					              <label class="charge-item">
					                <input type="radio" name="payType">
					                <div class="charge-item__inner">
					                  <button type="button" class="btn btn-info btn-lg" @click="pay()">去支付</button>
					                </div>
					              </label>
					            </div>
					          </div>
					        </div>
					      </form>
					    </div>
					  </div>
				</div>
	  	
				<div class="col-md-4">
					
						<div align="center"><div id='calendar' style="width: 100%;height: 100%;border:4px solid black">
								<h2>
									欢迎访问普格娱乐
								</h2>
								<p>
									内容持续更新中
								</p>
						</div>
					
				</div>
		</div>
		
		
   </div>
   
   
   <img src="" alt="" id="img">
   
   
   
   
   <div th:include="footer :: footer"></div> 
   <input id="user_name" th:value="${user_name}" name="user_name" type="text" style="display: none"> 
    
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/scripts.js"></script>
    
    <script type="text/javascript">
    	
       	var user_name=$("#user_name").val();
       	var query=null;
		var app=new Vue({
			  el: '#app',
			  data: {
				  
					  content: user_name,
					  plays:true
			  },
			  methods:{
				  islogin: function () {
					  
					  if(user_name!=null&&user_name!=''){
						  
						  this.plays=false;
					  }
				  }
			    }
			
			})
		
		  app.islogin();
		
		
		var app1=new Vue({
			  el: '#app1',
			  data: {
				  
				  	 type:''
					  
			  },
			  methods:{
				  
				  pay: function () {
					
					//获取当前选中充值金额
					var val = $('input[name="amount"]:checked').val();
					if(val==undefined){
						alert("请选择充值的金额");
						return false;
					}
				    //获取支付方式,并根据支付方式选取不同的方法处理
				    var type = $('#type').val();
				    var url="";
				    if(type==""||type==null){
				    	alert("请选择支付方式");
				    	return false;
				    }else if(type=="1"){//微信支付
				    	url="/wxpay/qrcode?total_fee="+val;
				    	var newWin=window.open (url, '普格娱乐充值', 'left=410,height=510, width=660, top=200,  toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no')
				    	//轮询查询微信订单是否成功
				    	 query=setInterval("orderquery()",500);
				    //alert("微信支付开通中,请等待");
				    }else if(type=="2"){//支付宝支付
				    	url="alipay";
				    	var form=$("<form>");//定义一个form表单
	          			form.attr("style","display:none");
	          			form.attr("target","");
	          			form.attr("method","get");
	          			form.attr("action",url);
	          			var input1=$("<input>");
	          			input1.attr("type","hidden");
	          			input1.attr("name","val");
	          			input1.attr("value",val);
	          			var input2=$("<input>");
	          			input2.attr("type","hidden");
	          			input2.attr("name","openid");
	          			input2.attr("value","");
	          			$("body").append(form);//将表单放置在web中
	          			form.append(input1);  
	          			form.append(input2);  
	          			form.submit();//表单提交 
				    }
				    
					
          			
          			
          		 },
				  paytype: function (message) {
						
						this.type=message;
				  }
						
			  }
			})
		
		 	function orderquery() {
	            $.ajax({
	                url: '/wxpay/orderquery',
	                async:true,
	                type: 'get',
	                success: function (data) {
	                	alert(data)
	                    alert(data.result_code);
	                	if(data.result_code=='ok'){
	                		window.clearInterval(query);
	                		alert("支付成功");
	                		location.href="/membership";
	                	}
	               }
	           })
       		}
	
	</script>
  </body>
</html>